# Copilot Instructions for HEX-CMFD Project

## 项目概述

这是一个基于 ANT-MOC 的六角形网格 CMFD（Coarse Mesh Finite Difference，粗网有限差分）求解器项目，用于中子输运问题的数值求解。

## 技术栈

- **语言**: C++17
- **构建系统**: CMake
- **主要依赖**: HDF5, MPI（可选）
- **数值方法**: MOC (Method of Characteristics) + CMFD 加速

## 代码规范

### 命名约定

- 类名：驼峰命名法 (CamelCase)
- 函数名：驼峰命名法 (camelCase)
- 变量名：小写下划线分隔 (snake_case)
- 常量：全大写下划线分隔 (UPPER_CASE)

### 注释要求

- **所有注释统一使用中文**
- 复杂算法需要详细的注释说明
- 函数开头应说明功能、参数和返回值

### 代码风格

- 遵循现有代码的缩进和格式
- 适当使用空行分隔逻辑块

## 特定要求

### 六角形网格处理

- 注意六角形网格的特殊拓扑结构（6 个邻居）
- 边界条件处理需考虑六角形几何
- 坐标系统使用轴向坐标或立方坐标

### CMFD 求解器

- 修改 CMFD 相关代码时注意收敛性
- 耦合系数计算需保持物理守恒
- 注意非结构网格与结构网格的转换

### 性能考虑

- 大规模问题需要考虑内存优化
- 循环密集部分考虑并行化可能性
- 避免不必要的数据拷贝

## 文件组织

- `src/solver/`: 求解器核心代码，包括 CMFD 实现
- `src/geometry/`: 几何处理，包括六角形网格定义
- `src/track/`: 特征线追踪相关
- `cases/`: 测试算例

## 调试和测试

- 修改代码后应考虑对应的测试用例
- 使用 LOG 输出关键信息以便调试
- 数值结果变化需要验证物理合理性

## 常见任务提示

- 修改 CMFD 算法时，重点关注 `Cmfd.cpp` 和 `Cmfd.h`
- 六角形网格相关修改涉及几何模块
- 输出结果通常使用 VTU 格式（ParaView 可视化）

## 回答问题时的偏好

- 逐行解释代码，我对并行计算，c++的都不算熟悉，但你要让我看懂，使用简洁准确的语言表述（如果有些东西是固定的模式/标准写法，你说出来；还有像一些宏定义这样的内容也需要解释一下）
- 提供代码修改时，给出完整上下文
- 解释算法时，说明物理意义
- 对于数值方法，必要时提供参考文献或理论依据
